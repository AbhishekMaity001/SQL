DROP TABLE IF EXISTS PROGMR;
DROP TABLE IF EXISTS SOFTWARE;
DROP TABLE IF EXISTS STUDIES;

CREATE TABLE PROGMR(
NAME VARCHAR(8) NOT NULL,
DOB DATE NOT NULL,
DOJ DATE NOT NULL,
SEX VARCHAR(1) NOT NULL,
PROF1 VARCHAR(8) NOT NULL,
PROF2 VARCHAR(8),
SAL DECIMAL(4,0),
CHECK (SAL > 0 OR SAL IS NULL),
PRIMARY KEY (NAME, DOB, DOJ)
);

CREATE TABLE SOFTWARE (
NAME VARCHAR(8) NOT NULL,
TITLE VARCHAR(20) NOT NULL,
DEV_IN VARCHAR(8) NOT NULL,
SCOST DECIMAL(5,0), 
DCOST DECIMAL(5,0),
SOLD INTEGER,
PRIMARY KEY (NAME, TITLE),
CONSTRAINT CHK_SCOST CHECK (SCOST>0 OR SOLD>0)
);

CREATE TABLE STUDIES(
NAME VARCHAR(8),
SPLACE VARCHAR(9),
COURSE VARCHAR(5),
CCOST NUMERIC(5),
PRIMARY KEY (NAME, COURSE),
CONSTRAINT CHK_CCOST CHECK (CCOST>0)
); 


TRUNCATE TABLE PROGMR;
--RECORDS INSERTION IN PROGMR TABLE
INSERT INTO PROGMR (NAME, DOB, DOJ, SEX, PROF1, PROF2, SAL) VALUES ('ANAND', '30-APR-1966', '21-APR-1992', 'M', 'PASCAL', 'BASIC', 3200);
INSERT INTO PROGMR (NAME, DOB, DOJ, SEX, PROF1, PROF2, SAL) VALUES ('ALTAF', '02-JUL-1964', '13-NOV-1990', 'M', 'CLIPPER', 'COBOL', 2800);
INSERT INTO PROGMR (NAME, DOB, DOJ, SEX, PROF1, PROF2, SAL) VALUES ('JAGADESH', '06-OCT-1970', '04-OCT-1994', 'M', 'ORACLE', 'JAVA', 4100);
INSERT INTO PROGMR (NAME, DOB, DOJ, SEX, PROF1, PROF2, SAL) VALUES ('JULIANA', '31-JAN-1968', '21-APR-1990', 'F', 'COBOL', 'DBASE', 3000);
INSERT INTO PROGMR (NAME, DOB, DOJ, SEX, PROF1, PROF2, SAL) VALUES ('KAMALA', '30-OCT-1968', '02-JAN-1992', 'F', 'C', 'DBASE', 2900);
INSERT INTO PROGMR (NAME, DOB, DOJ, SEX, PROF1, PROF2, SAL) VALUES ('MARY', '24-JUN-1970', '01-FEB-1991', 'F', 'C++', 'ORACLE', 4500);
INSERT INTO PROGMR (NAME, DOB, DOJ, SEX, PROF1, PROF2, SAL) VALUES ('NELSON', '11-SEP-1965', '11-OCT-1989', 'M', 'COBOL', 'DBASE', 2500);
INSERT INTO PROGMR (NAME, DOB, DOJ, SEX, PROF1, PROF2, SAL) VALUES ('PATRIC', '19-NOV-1965', '11-OCT-1989', 'M', 'PASCAL', 'CLIPPER', 2800);
INSERT INTO PROGMR (NAME, DOB, DOJ, SEX, PROF1, PROF2, SAL) VALUES ('QADIR', '31-AUG-1965', '21-APR-1993', 'M', 'ASSEMBLY', 'C', 3000);
INSERT INTO PROGMR (NAME, DOB, DOJ, SEX, PROF1, PROF2, SAL) VALUES ('RAMESH', '03-MAY-1967', '28-FEB-1991', 'M', 'PASCAL', 'DBASE', 3200);
INSERT INTO PROGMR (NAME, DOB, DOJ, SEX, PROF1, PROF2, SAL) VALUES ('REBECCA', '01-JAN-1967', '01-DEC-1990', 'F', 'BASIC', 'COBOL', 2500);
INSERT INTO PROGMR (NAME, DOB, DOJ, SEX, PROF1, PROF2, SAL) VALUES ('REMITHA', '26-APR-1970', '20-APR-1993', 'F', 'C', 'ASSEMBLY', 3600);
INSERT INTO PROGMR (NAME, DOB, DOJ, SEX, PROF1, PROF2, SAL) VALUES ('REVATHI', '02-DEC-1969', '02-JAN-1992', 'F', 'PASCAL', 'BASIC', 3700);
INSERT INTO PROGMR (NAME, DOB, DOJ, SEX, PROF1, PROF2, SAL) VALUES ('VIJAYA', '14-DEC-1965', '02-APR-1992', 'F', 'FOXPRO', 'C', 3500);
SELECT * FROM PROGMR;


  


TRUNCATE TABLE SOFTWARE;
--RECORDS INSERTION IN SOFTWARE TABLE
INSERT INTO SOFTWARE (NAME, TITLE, DEV_IN, SCOST, DCOST, SOLD) VALUES ('ANAND', 'PARACHUTES', 'BASIC', 400, 6000, 43);
INSERT INTO SOFTWARE (NAME, TITLE, DEV_IN, SCOST, DCOST, SOLD) VALUES ('ANAND', 'VIDEO TITLING PACK', 'PASCAL', 7500, 16000, 9);
INSERT INTO SOFTWARE (NAME, TITLE, DEV_IN, SCOST, DCOST, SOLD) VALUES ('JAGADESH', 'SERIAL LINK UTILITY', 'JAVA', 800, 7500, 10);
INSERT INTO SOFTWARE (NAME, TITLE, DEV_IN, SCOST, DCOST, SOLD) VALUES ('JAGADESH', 'SHARES MANAGEMENT', 'ORACLE', 3000, 12000, 14);
INSERT INTO SOFTWARE (NAME, TITLE, DEV_IN, SCOST, DCOST, SOLD) VALUES ('JULIANA', 'INVENTORY CONTROL', 'COBOL', 3000, 3500, 0);  -- check constraint
INSERT INTO SOFTWARE (NAME, TITLE, DEV_IN, SCOST, DCOST, SOLD) VALUES ('KAMALA', 'PAYROLL PACKAGE', 'DBASE', 9000, 20000, 7);
INSERT INTO SOFTWARE (NAME, TITLE, DEV_IN, SCOST, DCOST, SOLD) VALUES ('MARY', 'FINANCILA ACC S/W', 'ORACLE', 18000, 85000, 4);
INSERT INTO SOFTWARE (NAME, TITLE, DEV_IN, SCOST, DCOST, SOLD) VALUES ('MARY', 'CODE GENERATOR', 'C', 4500, 20000, 23);
INSERT INTO SOFTWARE (NAME, TITLE, DEV_IN, SCOST, DCOST, SOLD) VALUES ('MARY', 'READ ME ', 'C++', 300, 1200, 84);
INSERT INTO SOFTWARE (NAME, TITLE, DEV_IN, SCOST, DCOST, SOLD) VALUES ('PATRICK', 'GRAPHIC EDITOR', 'PASCAL', 750, 5000, 11);
INSERT INTO SOFTWARE (NAME, TITLE, DEV_IN, SCOST, DCOST, SOLD) VALUES ('QADIR', 'BOMBS AWAY', 'ASSEMBLY', 500, 530, 114);
INSERT INTO SOFTWARE (NAME, TITLE, DEV_IN, SCOST, DCOST, SOLD) VALUES ('QADIR', 'VACCINES', 'C', 1900, 3400, 21);
INSERT INTO SOFTWARE (NAME, TITLE, DEV_IN, SCOST, DCOST, SOLD) VALUES ('RAMESH', 'HOTEL MANAGEMENT', 'DBASE', 12000, 35000, 4);
INSERT INTO SOFTWARE (NAME, TITLE, DEV_IN, SCOST, DCOST, SOLD) VALUES ('RAMESH', 'DEAD LEE', 'PASCAL', 100, 4500, 73);
INSERT INTO SOFTWARE (NAME, TITLE, DEV_IN, SCOST, DCOST, SOLD) VALUES ('REMITHA', 'PC UTILITIES', 'C', 725, 5000, 51);
INSERT INTO SOFTWARE (NAME, TITLE, DEV_IN, SCOST, DCOST, SOLD) VALUES ('REMITHA', 'TSR HELP PACKAGE', 'ASSEMBLY', 2500, 6000, 6);
INSERT INTO SOFTWARE (NAME, TITLE, DEV_IN, SCOST, DCOST, SOLD) VALUES ('REVATHI', 'HOTEL MANAGEMENT', 'PASCAL', 1100, 75000, 2);
INSERT INTO SOFTWARE (NAME, TITLE, DEV_IN, SCOST, DCOST, SOLD) VALUES ('REVATHI', 'QUIZ MASTER', 'BASIC', 3200, 2100, 15);
INSERT INTO SOFTWARE (NAME, TITLE, DEV_IN, SCOST, DCOST, SOLD) VALUES ('VIJAYA', 'ISK EDITOR', 'C', 900, 700, 6);
SELECT * FROM SOFTWARE;






TRUNCATE TABLE STUDIES;
--RECORDS INSERTION IN STUDIES TABLE
INSERT INTO STUDIES (NAME, SPLACE, COURSE, CCOST)  VALUES ('ANAND', 'SABHARI', 'PGDCA', 4500);
INSERT INTO STUDIES (NAME, SPLACE, COURSE, CCOST)  VALUES ('ALTAF', 'CCIT', 'DCA', 7200);
INSERT INTO STUDIES (NAME, SPLACE, COURSE, CCOST)  VALUES ('JAGADESH', 'S.S.I.L', 'DCA', 3500);
INSERT INTO STUDIES (NAME, SPLACE, COURSE, CCOST)  VALUES ('JULIANA', 'BITS', 'DCA', 22000);
INSERT INTO STUDIES (NAME, SPLACE, COURSE, CCOST)  VALUES ('KAMALA', 'PRAGATHI', 'DCP', 5000);
INSERT INTO STUDIES (NAME, SPLACE, COURSE, CCOST)  VALUES ('MARY', 'SABHARI', 'DCP', 5000);
INSERT INTO STUDIES (NAME, SPLACE, COURSE, CCOST)  VALUES ('NELSON', 'PRAGATHI', 'DAP', 6200);
INSERT INTO STUDIES (NAME, SPLACE, COURSE, CCOST)  VALUES ('QADIR', 'APPLE', 'HDCP', 14000);
INSERT INTO STUDIES (NAME, SPLACE, COURSE, CCOST)  VALUES ('RAMESH', 'SABHARI', 'PGDCA', 4500);
INSERT INTO STUDIES (NAME, SPLACE, COURSE, CCOST)  VALUES ('REBECCA', 'BRILLIANT', 'DCA', 11000);
INSERT INTO STUDIES (NAME, SPLACE, COURSE, CCOST)  VALUES ('REMITHA', 'BDPS', 'DCS', 6000);
INSERT INTO STUDIES (NAME, SPLACE, COURSE, CCOST)  VALUES ('REVATHI', 'SABHARI', 'DAP', 5000);
INSERT INTO STUDIES (NAME, SPLACE, COURSE, CCOST)  VALUES ('VIJAYA', 'BDPS', 'DCA', 48000);
INSERT INTO STUDIES (NAME, SPLACE, COURSE, CCOST)  VALUES ('PATRICK', 'PRAGATHI', 'DCAP', 5200);
SELECT * FROM STUDIES;

SELECT * FROM PROGMR;
SELECT * FROM SOFTWARE;
SELECT * FROM STUDIES;
-------------------------------------------------------------------------------------


--3
SELECT AVG(SCOST) AS "AVERAGE SCOST" FROM SOFTWARE WHERE DEV_IN = 'PASCAL';


--4
SELECT NAME, AGE(current_date, dob) FROM PROGMR;  -- SELECT current_timestamp, current_date, current_time, age(date1, date2), now() 

--5
SELECT NAME from STUDIES WHERE COURSE='DAP';

--6
SELECT TITLE, COUNT(TITLE) FROM SOFTWARE
GROUP BY TITLE
HAVING COUNT(TITLE)=1

SELECT TITLE, SUM(SOLD) AS TOTAL_COPIES_SOLD FROM SOFTWARE
GROUP BY TITLE
ORDER BY TOTAL_COPIES_SOLD DESC LIMIT 1

--7
SELECT NAME, DOB, EXTRACT(MONTH FROM DOB) AS MNTH FROM PROGMR
WHERE EXTRACT(MONTH FROM DOB) =1;

--8
SELECT COURSE, CCOST FROM STUDIES
ORDER BY CCOST ASC LIMIT 1;

--9
SELECT COUNT(*) AS TOTAL FROM STUDIES
WHERE COURSE = 'PGDCA';

--10
SELECT SUM(SCOST) AS TOTAL_REVENUE FROM SOFTWARE
WHERE DEV_IN = 'C'

--11
SELECT * FROM SOFTWARE 
WHERE NAME = 'RAMESH'

--12
SELECT COUNT(*) AS TOTAL_SABHARI FROM STUDIES 
WHERE SPLACE = 'SABHARI'

--13
SELECT TITLE, SCOST*SOLD AS TOTAL_SALES, SUM(SCOST*SOLD) FROM SOFTWARE
GROUP BY TITLE, TOTAL_SALES
WHERE SCOST*SOLD  > 20000

SELECT NAME, SCOST, SOLD, (SCOST*SOLD) AS RESULT FROM SOFTWARE;




SELECT * FROM PROGMR;
SELECT * FROM SOFTWARE;
SELECT * FROM STUDIES;

-- FINDING THE UNIQUE RECORDS
SELECT NAME, COUNT(*) from STUDIES
GROUP BY NAME
HAVING COUNT(*)=1
;